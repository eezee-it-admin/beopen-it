<?xml version="1.0" encoding="utf-8" ?>
<openerp>
    <data>

        <template id="assets_frontend" inherit_id="website.assets_frontend" name="Configurator">
            <xpath expr="." position="inside">
                <link rel='stylesheet' href='/template_configurator/static/src/css/template_configurator.css'/>
                <script type="text/javascript"
                        src="/template_configurator/static/src/js/template_configurator.js"></script>
            </xpath>
        </template>

        <template id="configurator_for_code">
            <t t-call="website.layout">
                <t t-set="title">Configurator</t>
                <div class="oe_structure">
                    <div class="container">
                        <div itemprop="description" t-field="markettype.description" class="oe_structure mt16" id="markettype_full_description"/>

                        <section class="container openerp_website_pricing bg-white">

                            <form class="openerp_website_pricing_form form-inline" name="configurator">
                                <input type="hidden" name="market_type" t-att-value="markettype.code"/>
                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                <div class="row">
                                    <div class="col-md-9 col-xs-12">
                                        <div class="openerp_website_pricing_step">
                                            <t t-if="len(markettype.template_ids) > 1">

                                                <div class="openerp_website_pricing_step_head">
                                                    <h3 class="mt16 mb16 text-violet-dark">
                                                        <b>Edition</b>
                                                    </h3>
                                                </div>
                                                <div class="openerp_website_pricing_step_body mb16">
                                                    <div class="row">
                                                        <t t-foreach="markettype.template_ids" t-as="template">
                                                            <div class="col-md-4">
                                                                <div class="row openerp_website_pricing_app">
                                                                    <label>
                                                                        <div class="col-md-7 col-xs-7 openerp_website_pricing_app_name">
                                                                            <div class="openerp_website_pricing_app_real_name">
                                                                                <span>
                                                                                    <t t-esc="template.docker_image_id.flavor_id.name"/>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </label>
                                                                    <div class="col-md-2 col-xs-1">
                                                                        <t t-if="markettype.preferred_flavor_id.id == template.docker_image_id.flavor_id.id">
                                                                            <input type="radio" t-att-id="'flavor_%s' % template.docker_image_id.flavor_id.id"
                                                                                   name="flavor" t-att-value="template.docker_image_id.flavor_id.id"
                                                                                   class="openerp_website_pricing_app_radio" checked="checked">
                                                                            </input>
                                                                        </t>
                                                                        <t t-if="markettype.preferred_flavor_id.id != template.docker_image_id.flavor_id.id">
                                                                            <input type="radio" t-att-id="'flavor_%s' % template.docker_image_id.flavor_id.id"
                                                                                   name="flavor" t-att-value="template.docker_image_id.flavor_id.id"
                                                                                   class="openerp_website_pricing_app_radio">
                                                                            </input>
                                                                        </t>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </t>
                                                    </div>
                                                </div>
                                             </t>
                                            <t t-if="len(markettype.template_ids) == 1">
                                                <t t-foreach="markettype.template_ids" t-as="template">
                                                    <input type="hidden" t-att-id="'flavor_%s' % template.docker_image_id.flavor_id.id"
                                                           name="flavor" t-att-value="template.docker_image_id.flavor_id.id" checked="checked"/>
                                                </t>
                                            </t>
                                            <div class="openerp_website_pricing_step_head">
                                                <h3 class="mt16 mb16 text-violet-dark">Default <b>Apps</b> in this
                                                    package (
                                                    <b>
                                                        <t t-esc="markettype.price"/>
                                                        <span class="openerp_website_pricing_currency">
                                                            <t t-esc="markettype.currency_id.name"/>
                                                        </span>
                                                    </b>
                                                    / month)
                                                </h3>
                                            </div>
                                            <div class="openerp_website_pricing_step_body mb24">
                                                <div class="row">

                                                    <t t-foreach="default_modules" t-as="module">

                                                        <div class="col-md-4">
                                                            <div class="row openerp_website_pricing_app selected" data-toggle="tooltip" animation="true" html="true"
                                                                 t-att-title="module.module_id.description">
                                                                <label>
                                                                    <div class="col-md-3 col-xs-3 openerp_website_pricing_app_icon">
                                                                        <span t-field="module.module_id.image"
                                                                              t-field-options='{"widget": "image", "style": "width: 36px; height: 36px;"}'
                                                                              class="img-responsive icon_radius"/>
                                                                    </div>
                                                                    <div class="col-md-7 col-xs-7 openerp_website_pricing_app_name">
                                                                        <div class="openerp_website_pricing_app_real_name">
                                                                            <span>
                                                                                <t t-esc="module.module_id.name"/>
                                                                            </span>


                                                                        </div>
                                                                    </div>
                                                                </label>
                                                            </div>
                                                        </div>

                                                    </t>


                                                </div>
                                            </div>
                                            <div class="openerp_website_pricing_step_head">
                                                <h3 class="mt16 mb16 text-violet-dark">
                                                    <b>Optional Apps</b>
                                                    for this package
                                                </h3>
                                            </div>
                                            <div class="openerp_website_pricing_step_body mb16">
                                                <div class="row">

                                                    <t t-foreach="optional_modules" t-as="module">

                                                        <div class="col-md-4" t-att-data-flavor="module.flavor_id.id if module.flavor_id else -1">
                                                            <t t-set="dependenciesastext" t-value="module.module_id.description+' '"/>
                                                            <t t-set="dependenciesasname" t-value="''"/>
                                                            <t t-if="module.module_id.module_ids">
                                                                <t t-set="dependenciesastext" t-value="dependenciesastext+' '+'Requires : '"/>

                                                                <t t-foreach="module.module_id.module_ids" t-as="dependent_module">
                                                                    <t t-set="dependenciesastext" t-value="dependenciesastext+' '+dependent_module.name+','"/>
                                                                    <t t-set="dependenciesasname" t-value="dependenciesasname+','+dependent_module.odoo_module_name"/>
                                                                 </t>

                                                            </t>
                                                            <div class="row openerp_website_pricing_app" data-toggle="tooltip" animation="true" html="true"
                                                                 t-att-title="dependenciesastext[:-1]">
                                                                <label>
                                                                    <div class="col-md-3 col-xs-3 openerp_website_pricing_app_icon">
                                                                        <span t-field="module.module_id.image"
                                                                              t-field-options='{"widget": "image", "style": "width: 36px; height: 36px;"}'
                                                                              class="img-responsive icon_radius"/>
                                                                    </div>
                                                                    <div class="col-md-7 col-xs-7 openerp_website_pricing_app_name">
                                                                        <div class="openerp_website_pricing_app_real_name">
                                                                            <span>
                                                                                <t t-esc="module.module_id.name"/>
                                                                            </span>


                                                                            <t t-if="module.module_id.module_ids">
                                                                                <i class="fa fa-1x fa-link hidden-md"/>
                                                                            </t>

                                                                        </div>
                                                                        <div class="openerp_website_pricing_app_price">
                                                                            <b>
                                                                                <t t-esc="module.module_id.price"/>
                                                                                <span class="openerp_website_pricing_currency">
                                                                                    <t t-esc="module.module_id.currency_id.name"/>
                                                                                </span>
                                                                            </b>
                                                                            / month
                                                                        </div>
                                                                    </div>
                                                                </label>
                                                                <div class="col-md-2 col-xs-1">
                                                                    <input type="checkbox" t-att-name="module.module_id.odoo_module_name"
                                                                           t-att-id="'app_'+module.module_id.odoo_module_name"
                                                                           class="openerp_website_pricing_app_checkbox"
                                                                           t-att-data-app-name="module.module_id.odoo_module_name"
                                                                           t-att-data-app-depends="dependenciesasname[1:]"/>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </t>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 col-xs-12 mt16">
                                        <input type="radio" id="monthly_by" name="price_by" value="monthly"
                                               style="display:none;"/>
                                        <input type="radio" id="yearly_by" name="price_by" value="yearly"
                                               style="display:none;"/>
                                        <div class="odoo_pricing_board">
                                            <ul class="nav nav-tabs" style="">
                                                <li class="active" data-type="monthly">
                                                    <a data-toggle="tab" href="#monthly">Monthly</a>
                                                </li>
                                                <li data-type="yearly" class="invisible">
                                                    <a data-toggle="tab" href="#yearly">Annually
                                                        <small>(10 + 2 free)
                                                        </small>
                                                    </a>
                                                </li>
                                            </ul>
                                            <div class="tab-content" style="">
                                                <div class="tab-pane tab-pane-monthly active in" id="monthly">
                                                    <table class="table openerp_website_pricing_table_recurrent">
                                                        <tbody>
                                                            <tr>
                                                                <th class="text-violet-dark" colspan="2">Subscription
                                                                </th>
                                                            </tr>
                                                            <tr>
                                                                <td>
                                                                    <b>
                                                                        <span class="openerp_website_pricing_default_modules_num"><t t-esc="len(default_modules)"/></span>
                                                                    </b>
                                                                    Default Apps
                                                                </td>
                                                                <td class="text-right">
                                                                    <span class="openerp_website_pricing_default_modules_price_monthly"><t t-esc="markettype.price"/></span>
                                                                    <span class="openerp_website_pricing_currency"><t t-esc="markettype.currency_id.name"/></span>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>
                                                                    <b>
                                                                        <span class="openerp_website_pricing_optional_modules_num">0</span>
                                                                    </b>
                                                                    Optional Apps
                                                                </td>
                                                                <td class="text-right">
                                                                    <span class="openerp_website_pricing_optional_modules_price_monthly">0</span>
                                                                    <span class="openerp_website_pricing_currency"><t t-esc="markettype.currency_id.name"/></span>
                                                                </td>
                                                            </tr>
                                                            <tr class="active">
                                                                <td>
                                                                    <b>Total</b>
                                                                    / month
                                                                </td>
                                                                <td class="text-right">
                                                                    <b>
                                                                        <span class="openerp_website_pricing_price_monthly">0</span>
                                                                        <span class="openerp_website_pricing_currency"><t t-esc="markettype.currency_id.name"/></span>
                                                                    </b>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div class="tab-pane tab-pane-yearly" id="yearly">

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </section>
                        <div class="row">
                            <div class="col-md-9">
                                <div class="row">
                        			<div class="col-md-6">
                                        <div t-attf-class="form-group #{error.get('domain') and 'has-error' or ''}">
                                            <label class="control-label" for="contact_name">Domain</label>
                                            <input type="domain" name="domain" class="form-control" required="required" autofocus="autofocus"/>

                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div t-attf-class="form-group #{error.get('email') and 'has-error' or ''}">
                                            <label class="control-label" for="contact_name">Email</label>
                                            <input type="email" name="email" class="form-control" required="required"/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-12">
                                            <a class="btn btn-primary btn-block openerp_website_button_create_instance" href="https://beopen.be/trial"
                                           style="position: relative; overflow: hidden;">Start now
                                            <span style="opacity:0.65;">- 30 days Free trial</span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <t t-raw="'&lt;script>$(function () {'"/>
                          <t t-raw="'pricing_init(JSON.parse('"/><t t-raw="module_data"/><t t-raw="'));'"/>
                        <t t-raw="'});&lt;/script>'"/>

                        <div id="dialog" title="Ready">
                          <div>
                              <img src="/template_configurator/static/src/img/logo.png"/>
                              <p id="dialog-message"></p>
                          </div>
                        </div>


                    </div>
                </div>
            </t>
        </template>
    </data>
</openerp>